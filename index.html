<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <title>–ó—É—Ä–∞–≥ –∏–ª–≥—ç—ç—Ö</title>
</head>
<body>
  <h2>üì∏ –ó—É—Ä–∞–≥ –∏–ª–≥—ç—ç—Ö —Ç—É—Ä—à–∏–ª—Ç</h2>
  <video id="video" width="300" autoplay></video>
  <br>
  <button onclick="takeSnapshot()">–ó—É—Ä–∞–≥ –¥–∞—Ä–∞—Ö</button>
  <canvas id="canvas" width="300" height="200" style="display:none;"></canvas>

  <script type="module">
    import emailjs from 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js';

    emailjs.init('eLyD0g1O_O3XcFQ3d'); // ‚Üê —Ç–∞–Ω—ã public key

    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const context = canvas.getContext('2d');

    navigator.mediaDevices.getUserMedia({ video: true })
      .then((stream) => {
        video.srcObject = stream;
      })
      .catch((err) => {
        alert("–ö–∞–º–µ—Ä –∞—Å–∞–∞–≥“Ø–π: " + err);
      });

    window.takeSnapshot = function () {
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      const imageData = canvas.toDataURL('image/png');

      emailjs.send("service_i42qtc9", "template_6zilr7d", {
        image_url: imageData
      }).then(() => {
        alert("–ó—É—Ä–∞–≥ –∞–º–∂–∏–ª—Ç—Ç–∞–π –∏–ª–≥—ç—ç–≥–¥–ª—ç—ç!");
      }, (error) => {
        alert("–ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: " + JSON.stringify(error));
      });
    };
  </script>
</body>
</html>